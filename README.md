This is the segregated code for the patient detection and have the widget in it also.